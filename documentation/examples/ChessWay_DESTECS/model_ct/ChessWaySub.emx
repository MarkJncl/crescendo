<?xml version="1.0" encoding="UTF-8"?>
<Document>
  <Model version="4.2">
    <Sidops>
<![CDATA[ChessWay3d 0 0
    description '<Description>
   <IsMainModel>1</IsMainModel>
   <KeepParameterValues>True</KeepParameterValues>
   <Version>4.2</Version>
   <Description>Model generated by 3D-Mechanics Toolbox
	Original Filename: C:\Users\bebo\Documents\DestecsWorkspace130\ChessWay_DESTECS\model_ct\ChessWay 3D-2.3dm</Description>
   <LibraryPath>C:\Users\bebo\Documents\DestecsWorkspace130\ChessWay_DESTECS\model_ct\ChessWaySub.emx</LibraryPath>
   <TimeStamp>2012-6-7 16:19:52</TimeStamp>
</Description>';
type MechanicsModel
  ports
    signal out LeftWheelAbsH[4,4];
    signal out RightWheelAbsH[4,4];
    mechanical psi in LeftWheelContact[6];
    mechanical psi in RightWheelContact[6];
    signal out RBody[3,3];
    signal out VelocityCar[3];
    rotation psi in LeftWheelJoint;
    rotation psi in RightWheelJoint;
  restrictions
    causality fixed in LeftWheelContact;
    causality fixed in RightWheelContact;
    causality fixed in LeftWheelJoint;
    causality fixed in RightWheelJoint;
end;
icon bg bottom
 figures
  image 'C:\Users\bebo\Documents\DestecsWorkspace130\ChessWay_DESTECS\model_ct\ChessWay3dIcon.png' 0 0 128 128;
end;implementation eq
// 20-sim 3D Mechanics Editor
// C:\Users\bebo\Documents\DestecsWorkspace130\ChessWay_DESTECS\model_ct\ChessWay 3D-2.3dm

variables
	real hidden World\AbsH[4,4];
	real hidden World\mass_x_I[6,6];
	real hidden CarBodyFree\ConnectionPoint1\AbsH[4,4];
	real hidden CarBodyFree\AbsH[4,4];
	real hidden CarBodyFree\RelH[4,4];
	real hidden CarBodyFree\rotationInitial[4,4];
	real CarBodyFree\quat[4];
	real CarBodyFree\quatDot[4];
	real hidden CarBodyFree\quatInitial[4];
	real CarBodyFree\QOmega[4,4];
	real CarBodyFree\vgen[6];
	real CarBodyFree\x[3];
	real CarBodyFree\v[3];
	real CarBodyFree\vel[3];
	real CarBodyFree_Rot[4,4];
	real hidden CarBodyFree\ConnectionPoint2\AbsH[4,4];
	real hidden CarBody\AbsH[4,4];
	real hidden CarBody\mass_x_I[6,6];
	real hidden LeftWheelJoint\ConnectionPoint1\AbsH[4,4];
	real hidden LeftWheelJoint\AbsH[4,4];
	real hidden LeftWheelJoint\RelH[4,4];
	real LeftWheelJoint\phi;
	real LeftWheelJoint\omega;
	real LeftWheelJoint\sinTh;
	real LeftWheelJoint\CosTh;
	real LeftWheelJoint\Rot[3,3];
	real LeftWheelJoint\Pos[3];
	real hidden LeftWheelJoint\ConnectionPoint2\AbsH[4,4];
	real hidden LeftWheel\AbsH[4,4];
	real hidden LeftWheel\mass_x_I[6,6];
	real hidden LeftWheelAbsH\ConnectionPoint1\AbsH[4,4];
	real hidden LeftWheelContact\ConnectionPoint1\AbsH[4,4];
	real LeftWheelJoint\Wrench[1,6];
	real LeftWheelJoint\torque;
	real LeftWheelJoint\ConnectionPoint2\AbsHinverse[4,4];
	real hidden RightWheelJoint\ConnectionPoint1\AbsH[4,4];
	real hidden RightWheelJoint\AbsH[4,4];
	real hidden RightWheelJoint\RelH[4,4];
	real RightWheelJoint\phi;
	real RightWheelJoint\omega;
	real RightWheelJoint\sinTh;
	real RightWheelJoint\CosTh;
	real RightWheelJoint\Rot[3,3];
	real RightWheelJoint\Pos[3];
	real hidden RightWheelJoint\ConnectionPoint2\AbsH[4,4];
	real hidden RightWheel\AbsH[4,4];
	real hidden RightWheel\mass_x_I[6,6];
	real hidden RightWheelAbsH\ConnectionPoint1\AbsH[4,4];
	real hidden RightWheelContact\ConnectionPoint1\AbsH[4,4];
	real RightWheelJoint\Wrench[1,6];
	real RightWheelJoint\torque;
	real RightWheelJoint\ConnectionPoint2\AbsHinverse[4,4];
	real hidden RBody\ConnectionPoint1\AbsH[4,4];
	real hidden VelocityCar\ConnectionPoint1\AbsH[4,4];
	real v[8];
	real P[8];
	real PDot[8];
	real PDotBodies[8];
	real hidden AdjX1[6,6];
	real hidden AdjX1_T[6,6];
	real hidden adjAdjX1_1[6,6];
	real hidden adjAdjX1_2[6,6];
	real hidden adjAdjX1_3[6,6];
	real hidden adjAdjX1_4[6,6];
	real hidden adjAdjX1_5[6,6];
	real hidden adjAdjX1_6[6,6];
	real hidden AdjX2[6];
	real hidden AdjX2_T[1,6];
	real hidden adjAdjX2[6,6];
	real hidden AdjX3[6];
	real hidden AdjX3_T[1,6];
	real hidden adjAdjX3[6,6];
	real hidden J1[6,8];
	real hidden J2[6,8];
	real hidden J3[6,8];
	real hidden T1_00[6];
	real hidden T1_00T[1,6];
	real hidden T2_00[6];
	real hidden T2_00T[1,6];
	real hidden T3_00[6];
	real hidden T3_00T[1,6];
	real hidden M1[6,6];
	real hidden AdjInv1[6,6];
	real hidden TM1[1,6];
	real hidden M2[6,6];
	real hidden AdjInv2[6,6];
	real hidden TM2[1,6];
	real hidden M3[6,6];
	real hidden AdjInv3[6,6];
	real hidden TM3[1,6];
	real MassMatrix[8,8];
	real hidden M1_1[6,6];
	real hidden M2_1[1,6];
	real hidden M2_2;
	real hidden M3_1[1,6];
	real hidden M3_3;
	real hidden wrenchGrav1[1,6];
	real hidden wrenchGrav2[1,6];
	real hidden wrenchGrav3[1,6];
	real VelocityCar\ConnectionPoint1\invAdjointNoOriH[6,6];
	real VelocityCar\ConnectionPoint1\AbsHPos[3];
	real hidden VelocityCar_Flow[6];
	real CarBodyFree\Bk[6,6];
	real hidden CarBodyFree\skewP4to6[3,3];
	real TMSum1[1,6];
parameters
	real hidden World\H[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden World\I[6,6] = [
			0.1, 0, 0, 0, 0, 0;
			0, 0.1, 0, 0, 0, 0;
			0, 0, 0.1, 0, 0, 0;
			0, 0, 0, 1, 0, 0;
			0, 0, 0, 0, 1, 0;
			0, 0, 0, 0, 0, 1];
	real World\mass = 1;
	real hidden CarBodyFree\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real CarBodyFree\EulerXYZInitial[3] = [0; -0.0999999999999997; 0];
	real hidden CarBodyFree\xInitial[3] = [-0.1; 0; 1.1];
	real hidden CarBody\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden CarBody\I[6,6] = [
			0.00012037, 0, 0, 0, 0, 0;
			0, 0.00012037, 0, 0, 0, 0;
			0, 0, 0.00012037, 0, 0, 0;
			0, 0, 0, 1, 0, 0;
			0, 0, 0, 0, 1, 0;
			0, 0, 0, 0, 0, 1];
	real CarBody\mass = 90;
	real hidden LeftWheelJoint\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, -0.3;
			0, 0, 1, -0.9;
			0, 0, 0, 1];
	real LeftWheelJoint\phiInitial = 0;
	real hidden LeftWheel\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, -0.025;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden LeftWheel\I[6,6] = [
			0.0001333334, 0, 0, 0, 0, 0;
			0, 0.0002, 0, 0, 0, 0;
			0, 0, 0.0001333334, 0, 0, 0;
			0, 0, 0, 1, 0, 0;
			0, 0, 0, 0, 1, 0;
			0, 0, 0, 0, 0, 1];
	real LeftWheel\mass = 0.5;
	real hidden LeftWheelAbsH\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, -0.01;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden LeftWheelContact\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, -0.01;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden RightWheelJoint\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0.3;
			0, 0, 1, -0.9;
			0, 0, 0, 1];
	real RightWheelJoint\phiInitial = 0;
	real hidden RightWheel\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0.025;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden RightWheel\I[6,6] = [
			0.0001333334, 0, 0, 0, 0, 0;
			0, 0.0002, 0, 0, 0, 0;
			0, 0, 0.0001333334, 0, 0, 0;
			0, 0, 0, 1, 0, 0;
			0, 0, 0, 0, 1, 0;
			0, 0, 0, 0, 0, 1];
	real RightWheel\mass = 0.5;
	real hidden RightWheelAbsH\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0.01;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden RightWheelContact\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0.01;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden RBody\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0;
			0, 0, 1, 0;
			0, 0, 0, 1];
	real hidden VelocityCar\ConnectionPoint1\RelH[4,4] = [
			1, 0, 0, 0;
			0, 1, 0, 0;
			0, 0, 1, -0.025;
			0, 0, 0, 1];
	real hidden PDotInitial[8] = [0; 0; 0; 0; 0; 0; 0; 0];
initialequations
	CarBodyFree\rotationInitial = dll ('EulerAngles.dll', 'HMatrixFromEulXYZr', CarBodyFree\EulerXYZInitial);
	CarBodyFree\quatInitial = dll ('EulerAngles.dll', 'QuaternionFromHMatrix', CarBodyFree\rotationInitial);
	CarBodyFree\RelH[4, 1:3] = 0;
	CarBodyFree\RelH[4, 4] = 1;
	J1[1:6, 7] = 0;
	J1[1:6, 8] = 0;
	J2[1:6, 8] = 0;
	J3[1:6, 7] = 0;
	MassMatrix[7, 8] = 0;
	MassMatrix[8, 7] = 0;
	CarBodyFree\Bk[4:6, 4:6] = 0;
equations
	World\AbsH = World\H;
	World\mass_x_I = World\mass * World\I;
	CarBodyFree\ConnectionPoint1\AbsH = multiplyH (World\AbsH, CarBodyFree\ConnectionPoint1\RelH);
	CarBodyFree\QOmega = [0, -CarBodyFree\vgen[3], CarBodyFree\vgen[2], -CarBodyFree\vgen[1];
				CarBodyFree\vgen[3], 0, -CarBodyFree\vgen[1], -CarBodyFree\vgen[2];
				-CarBodyFree\vgen[2], CarBodyFree\vgen[1], 0, -CarBodyFree\vgen[3];
				CarBodyFree\vgen[1], CarBodyFree\vgen[2], CarBodyFree\vgen[3], 0];
	CarBodyFree\quat = int (CarBodyFree\quatDot) + CarBodyFree\quatInitial;
	CarBodyFree\quatDot = 0.5 * CarBodyFree\QOmega * CarBodyFree\quat;
	CarBodyFree\vel = CarBodyFree\vgen[4:6];
	CarBodyFree\v = skew (CarBodyFree\vgen[1:3]) * CarBodyFree\x + CarBodyFree\vel;
	CarBodyFree\x = int (CarBodyFree\v) + CarBodyFree\xInitial;
	CarBodyFree_Rot = dll ('EulerAngles.dll', 'HMatrixFromQuaternion', CarBodyFree\quat);
	CarBodyFree\RelH[1:3, 1:3] = CarBodyFree_Rot[1:3, 1:3];
	CarBodyFree\RelH[1:3, 4] = CarBodyFree\x;
	CarBodyFree\AbsH = multiplyH (CarBodyFree\ConnectionPoint1\AbsH, CarBodyFree\RelH);
	CarBodyFree\ConnectionPoint2\AbsH = CarBodyFree\AbsH;
	CarBody\AbsH = multiplyH (CarBodyFree\ConnectionPoint2\AbsH, CarBody\RelH);
	CarBody\mass_x_I = CarBody\mass * CarBody\I;
	LeftWheelJoint\ConnectionPoint1\AbsH = multiplyH (CarBody\AbsH, LeftWheelJoint\ConnectionPoint1\RelH);
	LeftWheelJoint\phi = int (LeftWheelJoint\omega) + LeftWheelJoint\phiInitial;
	LeftWheelJoint\sinTh = sin (LeftWheelJoint\phi);
	LeftWheelJoint\CosTh = cos (LeftWheelJoint\phi);
	LeftWheelJoint\Rot = [LeftWheelJoint\CosTh, 0, LeftWheelJoint\sinTh;
				0, 1, 0;
				-LeftWheelJoint\sinTh, 0, LeftWheelJoint\CosTh];
	LeftWheelJoint\Pos = 0;
	LeftWheelJoint\RelH = homogeneous (LeftWheelJoint\Rot, LeftWheelJoint\Pos);
	LeftWheelJoint\AbsH = multiplyH (LeftWheelJoint\ConnectionPoint1\AbsH, LeftWheelJoint\RelH);
	LeftWheelJoint\ConnectionPoint2\AbsH = LeftWheelJoint\AbsH;
	LeftWheel\AbsH = multiplyH (LeftWheelJoint\ConnectionPoint2\AbsH, LeftWheel\RelH);
	LeftWheel\mass_x_I = LeftWheel\mass * LeftWheel\I;
	LeftWheelAbsH\ConnectionPoint1\AbsH = multiplyH (LeftWheel\AbsH, LeftWheelAbsH\ConnectionPoint1\RelH);
	LeftWheelContact\ConnectionPoint1\AbsH = multiplyH (LeftWheel\AbsH, LeftWheelContact\ConnectionPoint1\RelH);
	LeftWheelJoint\ConnectionPoint2\AbsHinverse = inverseH (LeftWheelJoint\ConnectionPoint2\AbsH);
	LeftWheelJoint\Wrench = [0, LeftWheelJoint\torque, 0, 0, 0, 0] * Adjoint (LeftWheelJoint\ConnectionPoint2\AbsHinverse);
	RightWheelJoint\ConnectionPoint1\AbsH = multiplyH (CarBody\AbsH, RightWheelJoint\ConnectionPoint1\RelH);
	RightWheelJoint\phi = int (RightWheelJoint\omega) + RightWheelJoint\phiInitial;
	RightWheelJoint\sinTh = sin (RightWheelJoint\phi);
	RightWheelJoint\CosTh = cos (RightWheelJoint\phi);
	RightWheelJoint\Rot = [RightWheelJoint\CosTh, 0, RightWheelJoint\sinTh;
				0, 1, 0;
				-RightWheelJoint\sinTh, 0, RightWheelJoint\CosTh];
	RightWheelJoint\Pos = 0;
	RightWheelJoint\RelH = homogeneous (RightWheelJoint\Rot, RightWheelJoint\Pos);
	RightWheelJoint\AbsH = multiplyH (RightWheelJoint\ConnectionPoint1\AbsH, RightWheelJoint\RelH);
	RightWheelJoint\ConnectionPoint2\AbsH = RightWheelJoint\AbsH;
	RightWheel\AbsH = multiplyH (RightWheelJoint\ConnectionPoint2\AbsH, RightWheel\RelH);
	RightWheel\mass_x_I = RightWheel\mass * RightWheel\I;
	RightWheelAbsH\ConnectionPoint1\AbsH = multiplyH (RightWheel\AbsH, RightWheelAbsH\ConnectionPoint1\RelH);
	RightWheelContact\ConnectionPoint1\AbsH = multiplyH (RightWheel\AbsH, RightWheelContact\ConnectionPoint1\RelH);
	RightWheelJoint\ConnectionPoint2\AbsHinverse = inverseH (RightWheelJoint\ConnectionPoint2\AbsH);
	RightWheelJoint\Wrench = [0, RightWheelJoint\torque, 0, 0, 0, 0] * Adjoint (RightWheelJoint\ConnectionPoint2\AbsHinverse);
	RBody\ConnectionPoint1\AbsH = multiplyH (CarBody\AbsH, RBody\ConnectionPoint1\RelH);
	VelocityCar\ConnectionPoint1\AbsH = multiplyH (CarBody\AbsH, VelocityCar\ConnectionPoint1\RelH);
	AdjX1 = Adjoint (CarBodyFree\ConnectionPoint1\AbsH);
	AdjX1_T = transpose (AdjX1);
	adjAdjX1_1 = adjoint (AdjX1[1:6, 1]);
	adjAdjX1_2 = adjoint (AdjX1[1:6, 2]);
	adjAdjX1_3 = adjoint (AdjX1[1:6, 3]);
	adjAdjX1_4 = adjoint (AdjX1[1:6, 4]);
	adjAdjX1_5 = adjoint (AdjX1[1:6, 5]);
	adjAdjX1_6 = adjoint (AdjX1[1:6, 6]);
	AdjX2[1:3] = LeftWheelJoint\ConnectionPoint1\AbsH[1:3, 2];
	AdjX2[4] = LeftWheelJoint\ConnectionPoint1\AbsH[2, 4] * LeftWheelJoint\ConnectionPoint1\AbsH[3, 2] - LeftWheelJoint\ConnectionPoint1\AbsH[3, 4] * LeftWheelJoint\ConnectionPoint1\AbsH[2, 2];
	AdjX2[5] = LeftWheelJoint\ConnectionPoint1\AbsH[3, 4] * LeftWheelJoint\ConnectionPoint1\AbsH[1, 2] - LeftWheelJoint\ConnectionPoint1\AbsH[1, 4] * LeftWheelJoint\ConnectionPoint1\AbsH[3, 2];
	AdjX2[6] = LeftWheelJoint\ConnectionPoint1\AbsH[1, 4] * LeftWheelJoint\ConnectionPoint1\AbsH[2, 2] - LeftWheelJoint\ConnectionPoint1\AbsH[2, 4] * LeftWheelJoint\ConnectionPoint1\AbsH[1, 2];
	AdjX2_T = transpose (AdjX2);
	adjAdjX2 = adjoint (AdjX2);
	AdjX3[1:3] = RightWheelJoint\ConnectionPoint1\AbsH[1:3, 2];
	AdjX3[4] = RightWheelJoint\ConnectionPoint1\AbsH[2, 4] * RightWheelJoint\ConnectionPoint1\AbsH[3, 2] - RightWheelJoint\ConnectionPoint1\AbsH[3, 4] * RightWheelJoint\ConnectionPoint1\AbsH[2, 2];
	AdjX3[5] = RightWheelJoint\ConnectionPoint1\AbsH[3, 4] * RightWheelJoint\ConnectionPoint1\AbsH[1, 2] - RightWheelJoint\ConnectionPoint1\AbsH[1, 4] * RightWheelJoint\ConnectionPoint1\AbsH[3, 2];
	AdjX3[6] = RightWheelJoint\ConnectionPoint1\AbsH[1, 4] * RightWheelJoint\ConnectionPoint1\AbsH[2, 2] - RightWheelJoint\ConnectionPoint1\AbsH[2, 4] * RightWheelJoint\ConnectionPoint1\AbsH[1, 2];
	AdjX3_T = transpose (AdjX3);
	adjAdjX3 = adjoint (AdjX3);
	J1[1:6, 1:6] = AdjX1;
	J2[1:6, 1:6] = AdjX1;
	J2[1:6, 7] = AdjX2;
	J3[1:6, 1:6] = AdjX1;
	J3[1:6, 8] = AdjX3;
	T1_00 = J1 * v;
	T1_00T = transpose (T1_00);
	T2_00 = J2 * v;
	T2_00T = transpose (T2_00);
	T3_00 = J3 * v;
	T3_00T = transpose (T3_00);
	AdjInv1 = Adjoint (inverseH (CarBody\AbsH));
	M1 = transpose (AdjInv1) * CarBody\mass_x_I * AdjInv1;
	TM1 = T1_00T * M1;
	AdjInv2 = Adjoint (inverseH (LeftWheel\AbsH));
	M2 = transpose (AdjInv2) * LeftWheel\mass_x_I * AdjInv2;
	TM2 = T2_00T * M2;
	AdjInv3 = Adjoint (inverseH (RightWheel\AbsH));
	M3 = transpose (AdjInv3) * RightWheel\mass_x_I * AdjInv3;
	TM3 = T3_00T * M3;
	M1_1 = AdjX1_T * (M1 + M2 + M3) * AdjX1;
	M2_1 = AdjX2_T * M2 * AdjX1;
	M2_2 = AdjX2_T * M2 * AdjX2;
	M3_1 = AdjX3_T * M3 * AdjX1;
	M3_3 = AdjX3_T * M3 * AdjX3;
	MassMatrix[1:6, 1:6] = M1_1;
	MassMatrix[1:6, 7] = transpose (M2_1);
	MassMatrix[1:6, 8] = transpose (M3_1);
	MassMatrix[7, 1:6] = M2_1;
	MassMatrix[7, 7] = M2_2;
	MassMatrix[8, 1:6] = M3_1;
	MassMatrix[8, 8] = M3_3;
	wrenchGrav1 = CarBody\mass * [-9.81 * CarBody\AbsH[2, 4], 9.81 * CarBody\AbsH[1, 4], 0, 0, 0, -9.81];
	wrenchGrav2 = LeftWheel\mass * [-9.81 * LeftWheel\AbsH[2, 4], 9.81 * LeftWheel\AbsH[1, 4], 0, 0, 0, -9.81];
	wrenchGrav3 = RightWheel\mass * [-9.81 * RightWheel\AbsH[2, 4], 9.81 * RightWheel\AbsH[1, 4], 0, 0, 0, -9.81];
	LeftWheelAbsH = LeftWheelAbsH\ConnectionPoint1\AbsH;
	RightWheelAbsH = RightWheelAbsH\ConnectionPoint1\AbsH;
	LeftWheelContact.f = T2_00;
	RightWheelContact.f = T3_00;
	RBody = RBody\ConnectionPoint1\AbsH[1:3, 1:3];
	VelocityCar\ConnectionPoint1\AbsHPos = VelocityCar\ConnectionPoint1\AbsH[1:3, 4];
	VelocityCar\ConnectionPoint1\invAdjointNoOriH = Adjoint (eye (3), -VelocityCar\ConnectionPoint1\AbsHPos);
	VelocityCar_Flow = VelocityCar\ConnectionPoint1\invAdjointNoOriH * J1 * v;
	VelocityCar = VelocityCar_Flow[4:6];
	CarBodyFree\skewP4to6 = skew (P[4:6]);
	CarBodyFree\Bk[1:3, 1:3] = skew (P[1:3]);
	CarBodyFree\Bk[4:6, 1:3] = CarBodyFree\skewP4to6;
	CarBodyFree\Bk[1:3, 4:6] = CarBodyFree\skewP4to6;
	TMSum1 = TM1 + TM2 + TM3;
	PDotBodies[1:6] = -[TMSum1 * adjAdjX1_1 * T1_00;
				TMSum1 * adjAdjX1_2 * T1_00;
				TMSum1 * adjAdjX1_3 * T1_00;
				TMSum1 * adjAdjX1_4 * T1_00;
				TMSum1 * adjAdjX1_5 * T1_00;
				TMSum1 * adjAdjX1_6 * T1_00] - CarBodyFree\Bk * v[1:6];
	PDotBodies[7] = -(TM2 * adjAdjX2 * T2_00);
	PDotBodies[8] = -(TM3 * adjAdjX3 * T3_00);
	PDot = PDotBodies + transpose (wrenchGrav1 * J1 + wrenchGrav2 * J2 + wrenchGrav3 * J3 + transpose (LeftWheelContact.e) * J2 + transpose (RightWheelContact.e) * J3 + LeftWheelJoint\Wrench * (J2 - J1) + RightWheelJoint\Wrench * (J3 - J1));
	P = int (PDot) + PDotInitial;
	v = linsolve (MassMatrix, P, 'cholesky');
	LeftWheelJoint\omega = v[7];
	RightWheelJoint\omega = v[8];
	CarBodyFree\vgen = v[1:6];
	LeftWheelJoint\torque = LeftWheelJoint.e;
	LeftWheelJoint.f = LeftWheelJoint\omega;
	RightWheelJoint\torque = RightWheelJoint.e;
	RightWheelJoint.f = RightWheelJoint\omega;
implementation_end;
]]>
    </Sidops>
  </Model>
</Document>
