<project name="org.destecs.ide.copy" default="copy-projects">
	<target name="copy-projects" description="Copies all projects into place">
		<echo message="Copying sources into build folders" />
		<copy todir="${buildDirectory}/plugins">
			<fileset dir="../">
				<include name="ui/**" />
				<include name="core/**" />
				<include name="simeng/**" />
				<include name="debug/**" />
				<include name="platform/**" />
				<include name="vdmmetadatabuilder/**" />
				<include name="libraries/**" />
			</fileset>
		</copy>

		<!-- Platform plugin, manage version number -->
		<copy todir="${buildDirectory}/plugins" filtering="true">
			<fileset dir="../">
				<include name="platform/**" />
				<exclude name="**/target/" />
			</fileset>
		</copy>
		<copy file="../platform/plugin.properties" toFile="${buildDirectory}/plugins/platform/plugin.properties"
			overwrite="true" filtering="true">
			<filterchain>
				<replacetokens>
					<token key="version" value="${platformReleaseVersion}${RCVersion}" />
					<token key="builddate" value="${TODAY}" />
					<token key="gitrevision" value="${repository.version}" />
					<token key="svnurl" value="${svn.info.url}" />
				</replacetokens>
			</filterchain>
		</copy>
		<copy file="../platform/META-INF/MANIFEST.MF"
			toFile="${buildDirectory}/plugins/platform/META-INF/MANIFEST.MF"
			overwrite="true" filtering="true">
			<filterchain>
				<tokenfilter>
					<replaceregex pattern="Bundle-Version: 1.3.3"
						replace="Bundle-Version: ${platformReleaseVersion}" flags="gi" />
				</tokenfilter>
			</filterchain>
		</copy>

		<copy todir="${buildDirectory}">
			<fileset dir="../">
				<include name="features/rcp/**" />
				<exclude name="**/target/" />
			</fileset>

		</copy>
	</target>
</project>